<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>Adson App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #e8f0fe;
      text-align: center;
      padding: 30px;
    }
    .box {
      background: #ffffff;
      padding: 25px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin: auto;
      max-width: 400px;
    }
    .btn {
      background-color: #2AABEE;
      color: white;
      border: none;
      padding: 14px 24px;
      font-size: 18px;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 15px;
    }
    #pointMessage {
      margin-top: 10px;
      color: #333;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="box">
    <h2>ЁЯОп Adson App ржП рж╕рзНржмрж╛ржЧрждржо</h2>
    <p>ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзЗ ржкржпрж╝рзЗржирзНржЯ ржЕрж░рзНржЬржи ржХрж░рзБржиред</p>

    <button class="btn" onclick="watchAd()">ЁЯОе ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи</button>
    <div id="pointMessage"></div>
    <p style="margin-top:20px">ЁЯОБ ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рзЗрж▓ рж▓рж┐ржВржХ:<br>
      <code id="refLink"></code>
    </p>
  </div>

  <!-- Monetag Interstitial Ad SDK -->
  <script src='//libtl.com/sdk.js' data-zone='9417101' data-sdk='show_9417101'></script>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const userId = tg.initDataUnsafe?.user?.id || Math.floor(Math.random() * 1000000);
    const adCountKey = `adCount_${userId}`;
    const referredKey = `referred_${userId}`;
    let adCount = parseInt(localStorage.getItem(adCountKey)) || 0;

    // рж░рзЗржлрж╛рж░рзЗрж▓ ржЖржЗржбрж┐ ржмрзЗрж░ ржХрж░рзБржи
    const urlParams = new URLSearchParams(window.location.search);
    const ref = urlParams.get("start")?.startsWith("ref_") ? urlParams.get("start").split("ref_")[1] : null;

    // рж░рзЗржлрж╛рж░рзЗрж▓ ржкрзЯрзЗржирзНржЯ ржпрзБржХрзНржд ржХрж░рж╛рж░ ржЬржирзНржп рж▓рзЛржХрж╛рж▓ рж╕рзНржЯрзЛрж░рзЗржЬ ржЗржЙржЬ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ (ржбрзЗржорзЛ)
    if (ref && ref !== userId.toString() && !localStorage.getItem(referredKey)) {
      const refKey = `adCount_${ref}`;
      const prev = parseInt(localStorage.getItem(refKey)) || 0;
      localStorage.setItem(refKey, prev + 1); // рж░рзЗржлрж╛рж░рж╛рж░ржХрзЗ рзз ржкржпрж╝рзЗржирзНржЯ
      localStorage.setItem(referredKey, "true");
    }

    // рж░рзЗржлрж╛рж░рзЗрж▓ рж▓рж┐ржВржХ ржжрзЗржЦрж╛ржи
    const botUsername = "YOUR_BOT_USERNAME"; // ржЖржкржирж╛рж░ Bot ржПрж░ ржЗржЙржЬрж╛рж░ржирзЗржо ржмрж╕рж╛ржи
    const refLink = `https://t.me/${botUsername}?start=ref_${userId}`;
    document.getElementById("refLink").innerText = refLink;

    function watchAd() {
      alert("ЁЯОе ржмрж┐ржЬрзНржЮрж╛ржкржи рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...");
      if (typeof show_9417101 === "function") {
        show_9417101();
        adCount++;
        localStorage.setItem(adCountKey, adCount);
        document.getElementById("pointMessage").innerText = `тЬЕ ржЖржкржирж╛рж░ ржорзЛржЯ ржкржпрж╝рзЗржирзНржЯ: ${adCount}`;
      } else {
        alert("тЪая╕П ржмрж┐ржЬрзНржЮрж╛ржкржи рж▓рзЛржб рж╣ржпрж╝ржирж┐ред ржкрж░рзЗ ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред");
      }
    }
  </script>
</body>
</html>
